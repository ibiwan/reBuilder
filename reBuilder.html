<html><head><script>

    function reBuilder(){
        var expr = '';
        var names = [];

        function isString(a){return typeof a === 'string';}

        this.build = function(){
            expr = this.concat.apply(this, arguments);
        };

        this.concat = function(){
            return '(?:' + [].slice.call(arguments).filter(isString).join('') + ')';
        };

        this.or = function(){
            return '(?:' + [].slice.call(arguments).filter(isString).join('|') + ')';
        };

        this.named = function(tag) {
            names.push(tag);
            return this.capture.apply(this, [].slice.call(arguments, 1));
        };

        this.capture = function(){
            return '(' + this.concat.apply(this, arguments) + ')';
        };

        this.repeat = function(min, max, greedy){
            min = min || 0;
            max = max || Infinity;
            var counter = null;
                 if(min === 0 && max === 1)        { counter = '?'; }
            else if(min === 0 && max === Infinity) { counter = '*'; }
            else if(min === 1 && max === Infinity) { counter = '+'; }

            if(counter !== null){
                if(greedy === false){ counter += '?'; }
            } else {
                if(min === max){
                    counter = '{' + min + '}';
                } else {
                    counter = '{' + min + ',' + max + '}';
                }
            }

            var counted = this.concat.apply(this, [].slice.call(arguments, 3));
            return counted + counter;
        };

        this.generate = function(){
            try
            {
                return new RegExp(expr);
            }
            catch (e)
            {
                console.log('could not form re', expr, e);
                return null;
            }
        };

        this.charDigit = function(){
            return '\\d';
        };
    }

    var template = "(a{1,3})12(?:b|3)(\\d*?)(\\d+)";

    var rb = new reBuilder();
    rb.build(
        rb.capture(
            rb.repeat(1, 3, true, 'a')
        ),
        '12',
        rb.repeat(0, 1, true,
            rb.or(
                'b',
                '3'
            )
        ),
        rb.capture(
            rb.repeat(0, Infinity, false,
                rb.charDigit()
            )
        ),
        rb.named(
            'digits',
            rb.repeat(1, Infinity, true,
                rb.charDigit()
            )
        )
    );
    var re = rb.generate();
    console.log('re:', re);

    if(re !== null){
        var strings = [
            'abc',
            'aa12327',
            'aaaa12327',
            'a123b27',
            'a12b',
        ];
        for(var i = 0; i < strings.length; i++){
            console.log('match', strings[i], strings[i].match(re));
        }
    }



</script></script><body></body></html>